plan_task:
  description: >
    Decompose the following task into ordered user stories for autonomous execution.

    TASK:
    {{task}}

    Instructions:
    1. Explore the codebase to understand the stack, conventions, and patterns
    2. Break the task into small user stories (max 20)
    3. Order by dependency: schema/DB first, backend, frontend, integration
    4. Each story must fit in one developer session (one context window)
    5. Every acceptance criterion must be mechanically verifiable
    6. Always include "Typecheck passes" as the last criterion in every story
    7. Every story MUST include test criteria â€” "Tests for [feature] pass"
    8. The developer is expected to write tests as part of each story
  expected_output: >
    User stories with acceptance criteria, each fitting in one session
  agent: planner
